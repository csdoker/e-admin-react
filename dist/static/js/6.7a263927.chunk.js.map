{"version":3,"sources":["config/layout.js","api/role.js","components/upload-single-image/index.module.less","components/upload-single-image/UploadSingleImage.js","api/common.js","views/user/EditModal.js","views/user/User.js","views/user/index.js"],"names":["queryFormItemLayout","labelCol","xs","span","sm","wrapperCol","queryFormColLayout","xxl","lg","modalFormItemLayout","getRoles","params","request","method","url","getTotalRoles","createRole","data","updateRole","deleteRole","id","module","exports","QINIU_PREFIX","Avatar","props","handleChange","info","file","status","onChange","response","hash","setState","loading","imageUrl","beforeUpload","Promise","resolve","reject","then","res","token","err","console","log","value","state","this","uploadButton","className","styles","icon","type","uploadClass","imgClass","imgStyle","uploadCls","classNames","listType","action","showUploadList","spinning","src","style","alt","Component","FormItem","Item","Option","EditModal","create","submitting","handleOk","e","preventDefault","form","validateFields","values","a","detail","updateUser","password","createUser","md5","success","onCreateSuccess","onEditSuccess","message","destroy","handleCancel","onClose","resetFields","visible","roles","getFieldDecorator","title","width","onOk","onCancel","destroyOnClose","maskClosable","confirmLoading","label","rules","required","initialValue","avatar","UploadSingleImage","userName","placeholder","allowClear","autoComplete","fullName","enable","Group","buttonStyle","Button","Array","isArray","map","v","mode","getPopupContainer","triggerNode","parentNode","role","key","name","User","list","total","page","size","sorter","queryTotalRoles","query","Object","assign","getUsers","handleSearch","getFieldsValue","handleReset","handleTableChange","pagination","_","current","pageSize","field","order","sortProp","sortOrder","handlePaginationChange","handleToggleEnable","record","patchUser","item","handlePreview","history","push","handleDelete","confirm","content","centered","deleteUser","handleCreate","formRef","handleCreateSuccess","handleEdit","handleEditSuccess","handleModalClose","modalProps","showTotal","showQuickJumper","showSizeChanger","onShowSizeChange","columns","align","dataIndex","render","text","length","checked","disabled","formatDateTime","onClick","onSubmit","gutter","offset","htmlType","scroll","x","dataSource","rowKey","wrappedComponentRef","inst"],"mappings":"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","file":"static/js/6.7a263927.chunk.js","sourcesContent":["export const queryFormItemLayout = {\r\n  labelCol: {\r\n    xs: { span: 24 },\r\n    sm: { span: 5 }\r\n  },\r\n  wrapperCol: {\r\n    xs: { span: 24 },\r\n    sm: { span: 19 }\r\n  }\r\n}\r\n\r\nexport const queryFormColLayout = {\r\n  xxl: 6,\r\n  lg: 8\r\n}\r\n\r\nexport const modalFormItemLayout = {\r\n  labelCol: { span: 6 },\r\n  wrapperCol: { span: 14 }\r\n}\r\n","import request from '@/utils/request'\r\n\r\nexport const getRoles = params => {\r\n  return request({\r\n    method: 'get',\r\n    url: '/role',\r\n    params\r\n  })\r\n}\r\n\r\nexport const getTotalRoles = () => {\r\n  return request({\r\n    method: 'get',\r\n    url: '/role/total'\r\n  })\r\n}\r\n\r\nexport const createRole = params => {\r\n  return request({\r\n    method: 'post',\r\n    url: '/role',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport const updateRole = params => {\r\n  return request({\r\n    method: 'put',\r\n    url: '/role',\r\n    data: params\r\n  })\r\n}\r\n\r\nexport const deleteRole = params => {\r\n  return request({\r\n    method: 'delete',\r\n    url: `/role/${params.id}`\r\n  })\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"index_icon__Yo_6K\",\"uploadClass\":\"index_uploadClass__2zinK\",\"imgClass\":\"index_imgClass__bIlZS\"};","import React, { Component } from 'react'\r\nimport { Upload, Icon, Spin } from 'antd'\r\nimport styles from './index.module.less'\r\nimport { getQiniuToken } from '@/api/common'\r\nimport classNames from 'classnames'\r\n\r\nconst QINIU_PREFIX = 'https://qiniu.test.qyhever.com/'\r\nconst QINIU_UPLOAD_URL = 'https://upload-z2.qiniup.com'\r\n\r\nclass Avatar extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    const { value } = props\r\n    this.params = {}\r\n    this.state = {\r\n      loading: false,\r\n      imageUrl: value || ''\r\n    }\r\n  }\r\n\r\n  // componentDidUpdate(prevProps, prevState) {\r\n  //   console.log('componentDidUpdate', prevProps, prevState)\r\n  //   if (prevProps.value !== this.props.value) {\r\n  //     this.setState({\r\n  //       imageUrl: this.props.value || ''\r\n  //     })\r\n  //   }\r\n  // }\r\n  \r\n  // UNSAFE_componentWillReceiveProps(nextProps) {\r\n  //   if (nextProps.value !== this.props.value) {\r\n  //     this.setState({\r\n  //       imageUrl: nextProps.value || ''\r\n  //     })\r\n  //   }\r\n  // }\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.value !== state.value) {\r\n      return { imageUrl: props.value || '' }\r\n    }\r\n    return null\r\n  }\r\n\r\n  handleChange = (info) => {\r\n    if (info.file.status === 'done') {\r\n      const { onChange } = this.props\r\n      const { response } = info.file\r\n      const url = QINIU_PREFIX + response.hash\r\n      onChange(url)\r\n      this.setState({ loading: false, imageUrl: url })\r\n    }\r\n  }\r\n  \r\n  beforeUpload = () => {\r\n    return new Promise((resolve, reject) => {\r\n      this.setState({ loading: true })\r\n      getQiniuToken().then(res => {\r\n        const { token } = res.data\r\n        this.params.token = token\r\n        resolve(true)\r\n      }).catch(err => {\r\n        console.log(err)\r\n        this.setState({ loading: false })\r\n        reject(err)\r\n      })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { loading, imageUrl } = this.state\r\n    const uploadButton = (\r\n      <div>\r\n        {/* <Icon className={styles.icon} type={loading ? 'loading' : 'plus'} /> */}\r\n        {loading ? null : <Icon className={styles.icon} type=\"plus\" />}\r\n      </div>\r\n    )\r\n    const {\r\n      uploadClass = styles.uploadClass,\r\n      imgClass = styles.imgClass,\r\n      imgStyle\r\n    } = this.props\r\n    const uploadCls = classNames({\r\n      [uploadClass]: true,\r\n      'hover-mask': imageUrl\r\n    })\r\n    return (\r\n      <Upload\r\n        listType=\"picture-card\"\r\n        action={QINIU_UPLOAD_URL}\r\n        data={this.params}\r\n        className={uploadCls}\r\n        showUploadList={false}\r\n        beforeUpload={this.beforeUpload}\r\n        onChange={this.handleChange}\r\n      >\r\n        <Spin spinning={loading}></Spin>\r\n        {imageUrl ? <img src={imageUrl} style={imgStyle} className={imgClass} alt=\"avatar\" /> : uploadButton}\r\n        <div className=\"uploadr-mask\">\r\n          <Icon className={styles.icon} type=\"plus\" />\r\n        </div>\r\n      </Upload>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Avatar\r\n","import request from '@/utils/request'\r\n\r\nexport function getQiniuToken() {\r\n  return request({\r\n    method: 'get',\r\n    url: '/upload/qiniu_token'\r\n  })\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Modal, Form, Input, Radio, Select, message } from 'antd'\r\nimport md5 from 'md5'\r\nimport { modalFormItemLayout } from '@/config/layout'\r\nimport { createUser, updateUser } from '@/api/user'\r\nimport UploadSingleImage from '@/components/upload-single-image'\r\n\r\nconst { Item: FormItem } = Form\r\nconst { Option } = Select\r\n\r\n@Form.create()\r\nclass EditModal extends Component {\r\n  state = {\r\n    submitting: false\r\n  }\r\n  handleOk = (e) => {\r\n    e.preventDefault()\r\n    this.props.form.validateFields(async (err, values) => {\r\n      try {\r\n        if (err) return\r\n        const { detail } = this.props\r\n        this.setState({\r\n          submitting: true\r\n        })\r\n        let res = {}\r\n        if (detail.id) {\r\n          res = await updateUser({\r\n            ...values,\r\n            id: detail.id\r\n          })\r\n        } else {\r\n          const { password, ...params } = values\r\n          res = await createUser({\r\n            ...params,\r\n            password: md5(md5(password))\r\n          })\r\n        }\r\n        if (res.success) {\r\n          const {onCreateSuccess, onEditSuccess} = this.props\r\n          message.destroy()\r\n          message.success(detail.id ? '修改成功' : '添加成功')\r\n          detail.id ? onEditSuccess() : onCreateSuccess()\r\n        }\r\n      } catch (err) {\r\n        console.log(err)\r\n      } finally {\r\n        this.setState({\r\n          submitting: false\r\n        })\r\n      }\r\n    })\r\n  }\r\n  handleCancel = () => {\r\n    this.props.onClose()\r\n    this.props.form.resetFields()\r\n  }\r\n  render() {\r\n    const { visible, roles = [], detail, form } = this.props\r\n    const { submitting } = this.state\r\n    const { getFieldDecorator } = form\r\n    const title = detail.id ? '编辑' : '添加'\r\n    return (\r\n      <Modal\r\n        title={title}\r\n        width={600}\r\n        visible={visible}\r\n        onOk={this.handleOk}\r\n        onCancel={this.handleCancel}\r\n        destroyOnClose={false}\r\n        maskClosable={false}\r\n        confirmLoading={submitting}\r\n      >\r\n        <Form>\r\n        \r\n          <FormItem label=\"头像\" {...modalFormItemLayout}>\r\n            {getFieldDecorator('avatar', {\r\n              rules: [{ required: true, message: '请上传头像!' }],\r\n              initialValue: detail.avatar || ''\r\n            })(\r\n              <UploadSingleImage />\r\n            )}\r\n          </FormItem>\r\n          \r\n          <FormItem label=\"账户名\" {...modalFormItemLayout}>\r\n            {getFieldDecorator('userName', {\r\n              rules: [{ required: true, message: '请输入账户名!' }],\r\n              initialValue: detail.userName || ''\r\n            })(\r\n              <Input placeholder=\"请输入账户名\" allowClear autoComplete=\"off\" />\r\n            )}\r\n          </FormItem>\r\n          \r\n          <FormItem label=\"真实姓名\" {...modalFormItemLayout}>\r\n            {getFieldDecorator('fullName', {\r\n              rules: [{ required: true, message: '请输入真实姓名!' }],\r\n              initialValue: detail.fullName || ''\r\n            })(\r\n              <Input placeholder=\"请输入真实姓名\" allowClear autoComplete=\"off\" />\r\n            )}\r\n          </FormItem>\r\n          \r\n          {!detail.id &&\r\n            <FormItem label=\"密码\" {...modalFormItemLayout}>\r\n              {getFieldDecorator('password', {\r\n                rules: [{ required: true, message: '请输入密码!' }],\r\n                initialValue: detail.password || ''\r\n              })(\r\n                <Input type=\"password\" placeholder=\"请输入密码\" allowClear autoComplete=\"off\" />\r\n              )}\r\n            </FormItem>\r\n          }\r\n          \r\n          <FormItem label=\"状态\" {...modalFormItemLayout}>\r\n            {getFieldDecorator('enable', {\r\n              rules: [{ required: true, message: '请输入密码!' }],\r\n              initialValue: typeof detail.enable === 'undefined' ? true : detail.enable\r\n            })(\r\n              <Radio.Group buttonStyle=\"solid\">\r\n                <Radio.Button value={true}>启用</Radio.Button>\r\n                <Radio.Button value={false}>禁用</Radio.Button>\r\n              </Radio.Group>\r\n            )}\r\n          </FormItem>\r\n          \r\n          <FormItem label=\"角色\" {...modalFormItemLayout}>\r\n            {getFieldDecorator('role', {\r\n              rules: [{ required: true, message: '请选择角色!' }],\r\n              initialValue: Array.isArray(detail.roles) ? detail.roles.map(v => v.id) : []\r\n            })(\r\n              <Select\r\n                placeholder=\"请选择角色\"\r\n                mode=\"multiple\"\r\n                allowClear\r\n                getPopupContainer={triggerNode => triggerNode.parentNode}>\r\n                {roles.map(role =>\r\n                  <Option key={role.id} value={role.id}>{role.name}</Option>\r\n                )}\r\n              </Select>\r\n            )}\r\n          </FormItem>\r\n          \r\n        </Form>\r\n      </Modal>\r\n    )\r\n  }\r\n}\r\n\r\nexport default EditModal\r\n","import React, { Component } from 'react'\r\nimport { Form, Row, Col, Input, Button, Select, Table, Switch, Pagination, message, Modal } from 'antd'\r\nimport { queryFormItemLayout, queryFormColLayout } from '@/config/layout'\r\nimport { formatDateTime } from '@/utils'\r\nimport { getUsers, patchUser, deleteUser } from '@/api/user'\r\nimport EditModal from './EditModal'\r\nimport { getTotalRoles } from '@/api/role'\r\n\r\nconst { Item: FormItem } = Form\r\nconst { Option } = Select\r\n\r\n@Form.create()\r\nclass User extends Component {\r\n  state = {\r\n    loading: false,\r\n    list: [],\r\n    total: 0,\r\n    page: 1,\r\n    size: 10,\r\n    visible: false,\r\n    detail: {},\r\n    roles: []\r\n  }\r\n  form = {}\r\n  sorter = {}\r\n  componentDidMount() {\r\n    this.query()\r\n    this.queryTotalRoles()\r\n  }\r\n  queryTotalRoles = async () => {\r\n    try {\r\n      const res = await getTotalRoles()\r\n      if (res.success) {\r\n        const list = res.data || []\r\n        this.setState({\r\n          roles: list\r\n        })\r\n      }\r\n    } catch (err) {\r\n      console.log(err)\r\n    }\r\n  }\r\n  query = async () => {\r\n    try {\r\n      const params = Object.assign({}, this.form, this.sorter, {\r\n        page: this.state.page,\r\n        size: this.state.size\r\n      })\r\n      const res = await getUsers(loading => this.setState({loading}), params)\r\n      if (res.success) {\r\n        this.setState({\r\n          list: res.data.list || [],\r\n          total: res.data.total || 0\r\n        })\r\n      }\r\n    } catch (err) {\r\n      console.log(err)\r\n    }\r\n  }\r\n  handleSearch = e => {\r\n    e.preventDefault()\r\n    const values = this.props.form.getFieldsValue()\r\n    this.form = values\r\n    this.query()\r\n  }\r\n  handleReset = () => {\r\n    this.props.form.resetFields()\r\n    this.form = {}\r\n    this.query()\r\n  }\r\n  handleTableChange = (pagination, _, sorter) => {\r\n    const { current, pageSize } = pagination\r\n    this.setState({\r\n      page: current || 1,\r\n      size: pageSize || 10\r\n    }, () => {\r\n      const params = {}\r\n      if (sorter.field && sorter.order) {\r\n        params.sortProp = sorter.field\r\n        params.sortOrder = sorter.order === 'ascend' ? 1 : -1\r\n      } else {\r\n        params.sortProp = null\r\n        params.sortOrder = null\r\n      }\r\n      this.sorter = params\r\n      this.query()\r\n    })\r\n  }\r\n  handlePaginationChange = (page, size) => {\r\n    this.setState({\r\n      page,\r\n      size\r\n    }, () => {\r\n      this.query()\r\n    })\r\n  }\r\n  handleToggleEnable = async (record) => {\r\n    try {\r\n      const res = await patchUser(loading => this.setState({loading}), {\r\n        id: record.id,\r\n        enable: !record.enable\r\n      })\r\n      if (res.success) {\r\n        const list = this.state.list.map(item => {\r\n          if (item.id === record.id) {\r\n            return {\r\n              ...item,\r\n              enable: !item.enable\r\n            }\r\n          }\r\n          return item\r\n        })\r\n        this.setState({\r\n          list\r\n        })\r\n        message.destroy()\r\n        message.success('操作成功')\r\n      }\r\n    } catch (err) {\r\n      console.log(err)\r\n    }\r\n  }\r\n  handlePreview = (record) => {\r\n    this.props.history.push(`/user/detail?id=${record.id}`)\r\n  }\r\n  handleDelete = (record) => {\r\n    Modal.confirm({\r\n      title: '温馨提示',\r\n      content: '确定要删除吗？',\r\n      centered: true,\r\n      onOk: async () => {\r\n        try {\r\n          const res = await deleteUser(loading => this.setState({loading}), {\r\n            id: record.id\r\n          })\r\n          if (res.success) {\r\n            this.query()\r\n            message.destroy()\r\n            message.success('删除成功')\r\n          }\r\n        } catch (err) {\r\n          console.log(err)\r\n        }\r\n      },\r\n      onCancel: () => {\r\n        // ...\r\n      }\r\n    })\r\n  }\r\n  handleCreate = () => {\r\n    this.setState({\r\n      visible: true\r\n    })\r\n    console.log(this.formRef)\r\n  }\r\n  handleCreateSuccess = () => {\r\n    this.setState({\r\n      visible: false,\r\n      page: 1,\r\n      size: 10\r\n    }, () => {\r\n      this.query()\r\n    })\r\n  }\r\n  handleEdit = (record) => {\r\n    this.setState({\r\n      visible: true,\r\n      detail: record\r\n    })\r\n  }\r\n  handleEditSuccess = () => {\r\n    this.setState({\r\n      visible: false,\r\n      detail: {}\r\n    }, () => {\r\n      this.query()\r\n    })\r\n  }\r\n  handleModalClose = () => {\r\n    this.setState({\r\n      visible: false,\r\n      detail: {}\r\n    })\r\n  }\r\n  \r\n  render() {\r\n    const { getFieldDecorator } = this.props.form\r\n    const { loading, list, total, page, size, visible, detail, roles } = this.state\r\n    const modalProps = {\r\n      visible,\r\n      detail,\r\n      roles,\r\n      onCreateSuccess: this.handleCreateSuccess,\r\n      onEditSuccess: this.handleEditSuccess,\r\n      onClose: this.handleModalClose\r\n    }\r\n    const pagination = {\r\n      total,\r\n      current: page,\r\n      pageSize: size,\r\n      showTotal: total => `共${total}条`,\r\n      showQuickJumper: true,\r\n      showSizeChanger: true,\r\n      onChange: this.handlePaginationChange,\r\n      onShowSizeChange: this.handlePaginationChange\r\n    }\r\n    const columns = [{\r\n      title: '头像',\r\n      align: 'center',\r\n      dataIndex: 'avatar',\r\n      key: 'avatar',\r\n      render: text => <img src={text} className=\"avatar\" alt=\"加载失败\" />\r\n    }, {\r\n      title: '用户名',\r\n      align: 'center',\r\n      dataIndex: 'userName',\r\n      key: 'userName'\r\n    }, {\r\n      title: '真实姓名',\r\n      align: 'center',\r\n      dataIndex: 'fullName',\r\n      key: 'fullName'\r\n    }, {\r\n      title: '角色',\r\n      align: 'center',\r\n      dataIndex: 'roles',\r\n      key: 'roles',\r\n      render: (text) => {\r\n        if (text && text.length) {\r\n          return text.map(role =>\r\n            <span key={role.id}>{role.name}<br/></span>\r\n          )\r\n        }\r\n        return <span>-</span>\r\n      }\r\n    }, {\r\n      title: '启用状态',\r\n      align: 'center',\r\n      dataIndex: 'enable',\r\n      key: 'enable',\r\n      render: (text, record) => {\r\n        const disabled = record.userName === 'admin'\r\n        if (disabled) {\r\n          return <span>-</span>\r\n        }\r\n        return <Switch checked={text} disabled={loading} onChange={value => this.handleToggleEnable(record, value)} />\r\n      }\r\n    }, {\r\n      title: '添加时间',\r\n      align: 'center',\r\n      dataIndex: 'createdAt',\r\n      key: 'createdAt',\r\n      sorter: true,\r\n      // sortOrder: sortOrder,\r\n      render: (text) => <span>{text ? formatDateTime(text) : '-'}</span>\r\n    }, {\r\n      title: '修改时间',\r\n      align: 'center',\r\n      dataIndex: 'updatedAt',\r\n      key: 'updatedAt',\r\n      sorter: true,\r\n      // sortOrder: sortOrder,\r\n      render: (text) => <span>{text ? formatDateTime(text) : '-'}</span>\r\n    }, {\r\n      title: '操作',\r\n      align: 'center',\r\n      dataIndex: 'operation',\r\n      key: 'operation',\r\n      render: (_, record) => {\r\n        if (record.userName === 'admin') {\r\n          return <span>-</span>\r\n        }\r\n        return (\r\n          <span>\r\n            <Button type=\"link\" onClick={() => this.handlePreview(record)}>查看</Button>\r\n            <Button type=\"link\" onClick={() => this.handleEdit(record)}>编辑</Button>\r\n            <Button type=\"link\" disabled={loading} onClick={() => this.handleDelete(record)}>删除</Button>\r\n          </span>\r\n        )\r\n      }\r\n    }]\r\n    return (\r\n      <div className=\"com-container\">\r\n        <Form onSubmit={this.handleSearch}>\r\n          <Row gutter={24}>\r\n\r\n            <Col {...queryFormColLayout}>\r\n              <FormItem label=\"用户名\" {...queryFormItemLayout}>\r\n                {getFieldDecorator('userName', {\r\n                  initialValue: ''\r\n                })(\r\n                  <Input placeholder=\"请输入用户名\" allowClear autoComplete=\"off\" />\r\n                )}\r\n              </FormItem>\r\n            </Col>\r\n\r\n            <Col {...queryFormColLayout}>\r\n              <FormItem label=\"真实姓名\" {...queryFormItemLayout}>\r\n                {getFieldDecorator('fullName', {\r\n                  initialValue: ''\r\n                })(\r\n                  <Input placeholder=\"请输入真实姓名\" allowClear autoComplete=\"off\" />\r\n                )}\r\n              </FormItem>\r\n            </Col>\r\n\r\n            <Col {...queryFormColLayout}>\r\n              <FormItem label=\"启用状态\" {...queryFormItemLayout}>\r\n                {getFieldDecorator('enable', {\r\n                  initialValue: ''\r\n                })(\r\n                  <Select\r\n                    placeholder=\"请选择状态\"\r\n                    allowClear\r\n                    getPopupContainer={triggerNode => triggerNode.parentNode}>\r\n                    <Option value=\"\">全部</Option>\r\n                    <Option value={1}>启用</Option>\r\n                    <Option value={0}>禁用</Option>\r\n                  </Select>\r\n                )}\r\n              </FormItem>\r\n            </Col>\r\n\r\n            <Col {...queryFormColLayout}>\r\n              <FormItem wrapperCol={{offset: 2}}>\r\n                <Button type=\"primary\" htmlType=\"submit\" disabled={loading} onSubmit={this.handleSearch}>查询</Button>\r\n                <Button onClick={this.handleReset} disabled={loading}>重置</Button>\r\n                <Button type=\"primary\" onClick={this.handleCreate}>添加</Button>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n\r\n        </Form>\r\n        <div className=\"table-container\">\r\n          <Table\r\n            scroll={{ x: 1376 }}\r\n            loading={loading}\r\n            dataSource={list}\r\n            columns={columns}\r\n            rowKey=\"id\"\r\n            pagination={false}\r\n            onChange={this.handleTableChange}\r\n          />\r\n        </div>\r\n        <div className=\"pagination-container\">\r\n          <Pagination {...pagination} />\r\n        </div>\r\n        <EditModal {...modalProps} wrappedComponentRef={(inst) => this.formRef = inst} />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default User\r\n","export { default } from './User'\r\n"],"sourceRoot":""}