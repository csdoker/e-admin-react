(this["webpackJsonpe-admin-react"]=this["webpackJsonpe-admin-react"]||[]).push([[7],{792:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c}));var a={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},r={xxl:6,lg:8},c={labelCol:{span:6},wrapperCol:{span:14}}},799:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return i}));var a=n(92),r=function(e){return Object(a.a)({method:"get",url:"/role",params:e})},c=function(){return Object(a.a)({method:"get",url:"/role/total"})},o=function(e){return Object(a.a)({method:"post",url:"/role",data:e})},s=function(e){return Object(a.a)({method:"put",url:"/role",data:e})},i=function(e){return Object(a.a)({method:"delete",url:"/role/".concat(e.id)})}},800:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return l}));var a=n(92),r=function(e){return Object(a.a)({method:"get",url:"/resource",params:e})},c=function(e){return Object(a.a)({method:"get",url:"/resource/total",params:e})},o=function(e){return Object(a.a)({method:"get",url:"/resource/dir",params:e})},s=function(e){return Object(a.a)({method:"post",url:"/resource",data:e})},i=function(e){return Object(a.a)({method:"put",url:"/resource",data:e})},u=function(e){return Object(a.a)({method:"patch",url:"/resource",data:e})},l=function(e){return Object(a.a)({method:"delete",url:"/resource/".concat(e.id),params:e})}},943:function(e,t,n){"use strict";n.r(t);n(797);var a,r=n(801),c=(n(820),n(819)),o=(n(804),n(817)),s=(n(805),n(818)),i=(n(366),n(199)),u=(n(127),n(47)),l=(n(255),n(100)),d=(n(793),n(794)),p=n(128),f=n.n(p),h=n(196),m=n(62),b=n(63),g=n(66),y=n(64),O=n(65),v=(n(367),n(155)),k=n(0),j=n.n(k),C=n(792),E=n(203),x=n(799),S=n(800),w=n(74),T=n(264),K=(n(929),n(932)),P=K.a.TreeNode,q=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(g.a)(this,Object(y.a)(t).call(this,e))).onCheck=function(e,t){var a=t.halfCheckedKeys,r=[].concat(Object(T.a)(e),Object(T.a)(a));n.setState({checkedKeys:e,keys:r}),n.props.onChange({checkedKeys:e,keys:r})},n.onExpand=function(e){n.setState({expandedKeys:e,autoExpandParent:!0})},n.renderTreeNodes=function(e){return e.map((function(e){return e.children?j.a.createElement(P,{title:e.name,key:e.id,dataRef:e},n.renderTreeNodes(e.children)):j.a.createElement(P,{key:e.id,title:e.name})}))};var a=e.value,r=a.checkedKeys,c=a.keys;return n.state={checkedKeys:r||[],keys:c||[],resourceTree:[],expandedKeys:[],autoExpandParent:!0},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.resourceTree;return j.a.createElement(K.a,{autoExpandParent:this.state.autoExpandParent,checkable:!0,selectable:!1,onExpand:this.onExpand,expandedKeys:this.state.expandedKeys,onCheck:this.onCheck,checkedKeys:this.state.checkedKeys},this.renderTreeNodes(e))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value.checkedKeys.length!==t.checkedKeys.length?{checkedKeys:e.value.checkedKeys}:e.value.keys.length!==t.keys.length?{keys:e.value.keys}:e.resourceTree.length!==t.resourceTree.length?{expandedKeys:e.resourceTree.map((function(e){return e.id})),resourceTree:e.resourceTree}:null}}]),t}(k.Component);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(n,!0).forEach((function(t){Object(w.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R,F=v.a.Item,N=v.a.create()(a=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(g.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,submitting:!1,detail:{}},n.open=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id?"\u7f16\u8f91":"\u6dfb\u52a0",a={title:t,visible:!0};e.id&&(a.detail=e),n.setState(a)},n.handleOk=function(e){e.preventDefault(),n.props.form.validateFields(function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r,c,o,s,i,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=3;break}return e.abrupt("return");case 3:if(r=n.state.detail,n.setState({submitting:!0}),c={},o=a.resources.keys.map(Number),!r.id){e.next=13;break}return e.next=10,Object(x.e)(z({},a,{id:r.id,resources:o}));case 10:c=e.sent,e.next=16;break;case 13:return e.next=15,Object(x.a)(z({},a,{resources:o}));case 15:c=e.sent;case 16:c.success&&(s=n.props,i=s.onCreateSuccess,u=s.onEditSuccess,l.a.destroy(),l.a.success(r.id?"\u4fee\u6539\u6210\u529f":"\u6dfb\u52a0\u6210\u529f"),n.handleCancel(),r.id?u():i()),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:return e.prev=22,n.setState({submitting:!1}),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,19,22,25]])})));return function(t,n){return e.apply(this,arguments)}}())},n.handleCancel=function(){n.setState({visible:!1,detail:{}}),n.props.form.resetFields()},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props,t=e.resourceTree,n=void 0===t?[]:t,a=e.form,r=this.state,c=r.visible,o=r.submitting,s=r.detail,u=r.title,l=a.getFieldDecorator,p=s.resources||[],f=p.map((function(e){return e.id})),h=p.filter((function(e){return"2"===e.type})).map((function(e){return e.id}));return j.a.createElement(d.a,{title:u,width:600,visible:c,onOk:this.handleOk,onCancel:this.handleCancel,destroyOnClose:!1,maskClosable:!1,confirmLoading:o},j.a.createElement(v.a,null,j.a.createElement(F,Object.assign({label:"\u89d2\u8272\u540d"},C.a),l("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d!"}],initialValue:s.name||""})(j.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d",allowClear:!0,autoComplete:"off"}))),j.a.createElement(F,Object.assign({label:"\u89d2\u8272\u63cf\u8ff0"},C.a),l("description",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0!"}],initialValue:s.description||""})(j.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0",allowClear:!0,autoComplete:"off"}))),j.a.createElement(F,Object.assign({label:"\u53ef\u7528\u6743\u9650"},C.a),l("resources",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7236\u7ea7\u83dc\u5355!"}],initialValue:{checkedKeys:h,keys:f}})(j.a.createElement(q,{resourceTree:n})))))}}]),t}(k.Component))||a,I=v.a.Item,A=v.a.create()(R=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(g.a)(this,Object(y.a)(t).call(this,e))).state={loading:!1,deleting:!1,list:[],total:0,page:1,size:10,resourceTree:[]},n.form={},n.sorter={},n.query=Object(h.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.setState({loading:!0}),t=Object.assign({},n.form,n.sorter,{page:n.state.page,size:n.state.size}),e.next=5,Object(x.c)(t);case 5:(a=e.sent).success&&n.setState({list:a.data.list||[],total:a.data.total||0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.prev=12,n.setState({loading:!1}),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),n.queryTotalResources=Object(h.a)(f.a.mark((function e(){var t,a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(S.e)();case 3:(t=e.sent).success&&(a=t.data||[],r=Object(E.d)(a,null,"code","parentCode"),n.setState({resourceTree:r})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.handleSearch=function(e){e.preventDefault();var t=n.props.form.getFieldsValue();n.form=t,n.query()},n.handleReset=function(){n.props.form.resetFields(),n.form={},n.query()},n.handleTableChange=function(e,t,a){var r=e.current,c=e.pageSize;n.setState({page:r||1,size:c||10},(function(){var e={};a.field&&a.order?(e.sortProp=a.field,e.sortOrder="ascend"===a.order?1:-1):(e.sortProp=null,e.sortOrder=null),n.sorter=e,n.query()}))},n.handlePaginationChange=function(e,t){n.setState({page:e,size:t},(function(){n.query()}))},n.handleDelete=function(e){d.a.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",centered:!0,onOk:function(){n.setState({deleting:!0,loading:!0},Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(x.b)({id:e.id});case 3:t.sent.success&&(n.query(),l.a.destroy(),l.a.success("\u5220\u9664\u6210\u529f")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:return t.prev=10,n.setState({deleting:!1,loading:!1}),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])}))))},onCancel:function(){}})},n.handleCreate=function(){n.modalRef.open()},n.handleCreateSuccess=function(){n.setState({page:1,size:10},(function(){n.query()}))},n.handleEdit=function(e){n.modalRef.open(e)},n.modalRefFn=function(e){return n.modalRef=e},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.query(),this.queryTotalResources()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,n=this.state,a=n.loading,l=n.list,d=n.total,p=n.page,f=n.size,h={resourceTree:n.resourceTree,onCreateSuccess:this.handleCreateSuccess,onEditSuccess:function(){return e.query()}},m={total:d,current:p,pageSize:f,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:this.handlePaginationChange,onShowSizeChange:this.handlePaginationChange},b=[{title:"\u89d2\u8272\u540d",align:"center",dataIndex:"name",key:"name"},{title:"\u89d2\u8272\u63cf\u8ff0",align:"center",dataIndex:"description",key:"description"},{title:"\u6dfb\u52a0\u65f6\u95f4",align:"center",dataIndex:"createdAt",key:"createdAt",sorter:!0,render:function(e){return j.a.createElement("span",null,e?Object(E.a)(e):"-")}},{title:"\u4fee\u6539\u65f6\u95f4",align:"center",dataIndex:"updatedAt",key:"updatedAt",sorter:!0,render:function(e){return j.a.createElement("span",null,e?Object(E.a)(e):"-")}},{title:"\u64cd\u4f5c",align:"center",dataIndex:"operation",key:"operation",render:function(t,n){return"\u8d85\u7ea7\u7ba1\u7406\u5458"===n.name?j.a.createElement("span",null,"-"):j.a.createElement("span",null,j.a.createElement(u.a,{type:"link",onClick:function(){return e.handleEdit(n)}},"\u7f16\u8f91"),j.a.createElement(u.a,{type:"link",disabled:e.state.deleting,onClick:function(){return e.handleDelete(n)}},"\u5220\u9664"))}}];return j.a.createElement("div",{className:"com-container"},j.a.createElement(v.a,{onSubmit:this.handleSearch},j.a.createElement(o.a,{gutter:24},j.a.createElement(s.a,C.b,j.a.createElement(I,Object.assign({label:"\u89d2\u8272\u540d"},C.c),t("name",{initialValue:""})(j.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d",allowClear:!0,autoComplete:"off"})))),j.a.createElement(s.a,C.b,j.a.createElement(I,{wrapperCol:{offset:2}},j.a.createElement(u.a,{type:"primary",htmlType:"submit",disabled:a,onSubmit:this.handleSearch},"\u67e5\u8be2"),j.a.createElement(u.a,{onClick:this.handleReset,disabled:a},"\u91cd\u7f6e"),j.a.createElement(u.a,{type:"primary",onClick:this.handleCreate},"\u6dfb\u52a0"))))),j.a.createElement("div",{className:"table-container"},j.a.createElement(c.a,{scroll:{x:1376},loading:a,dataSource:l,columns:b,rowKey:"id",pagination:!1,onChange:this.handleTableChange})),j.a.createElement("div",{className:"pagination-container"},j.a.createElement(r.a,m)),j.a.createElement(N,Object.assign({},h,{wrappedComponentRef:this.modalRefFn})))}}]),t}(k.Component))||R;n.d(t,"default",(function(){return A}))}}]);
//# sourceMappingURL=7.9fb4cbfb.chunk.js.map