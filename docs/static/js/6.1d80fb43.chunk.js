(this["webpackJsonpe-admin-react"]=this["webpackJsonpe-admin-react"]||[]).push([[6],{520:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));var n={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},r={xxl:6,lg:8},l={labelCol:{span:6},wrapperCol:{span:14}}},526:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return o}));a(189),a(190),a(188),a(142),a(141),a(191);var n=a(66),r=a(80),l=a.n(r);function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var c=function(e){return l()(e).format("YYYY-MM-DD HH:mm:ss")};function o(e,t,a,r){var l=[];return e.filter((function(e){return e[r]===t})).forEach((function(t){l.push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t,{id:String(t.id),children:o(e,t[a],a,r)}))})),l}},529:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return o}));var n=a(61),r=function(e){return Object(n.a)({method:"get",url:"/role",params:e})},l=function(){return Object(n.a)({method:"get",url:"/role/total"})},i=function(e){return Object(n.a)({method:"post",url:"/role",data:e})},c=function(e){return Object(n.a)({method:"put",url:"/role",data:e})},o=function(e){return Object(n.a)({method:"delete",url:"/role/".concat(e.id)})}},581:function(e,t,a){e.exports={icon:"index_icon__Yo_6K",uploadClass:"index_uploadClass__2zinK",imgClass:"index_imgClass__bIlZS"}},671:function(e,t,a){"use strict";a.r(t);a(189),a(190),a(188),a(142),a(141),a(191),a(527);var n=a(531),r=(a(550),a(549)),l=(a(534),a(547)),i=(a(535),a(548)),c=(a(275),a(147)),o=(a(111),a(35)),s=(a(536),a(544)),u=(a(273),a(521),a(523)),d=(a(274),a(93)),p=a(66),f=(a(522),a(92)),m=a.n(f),b=(a(192),a(145)),h=a(38),g=a(39),v=a(41),O=a(40),y=a(42),j=(a(525),a(524)),E=(a(276),a(113)),C=a(0),w=a.n(C),k=a(520),S=a(526),x=a(200),P=(a(533),a(532)),N=a(664),D=a(180),q=a.n(D),z=(a(665),a(662)),I=(a(278),a(196)),_=(a(115),a(5)),V=(a(291),a(581)),T=a.n(V),A=a(61);var U,F=a(2),R=a.n(F),M="https://qiniu.test.qyhever.com/",Y=function(e){function t(e){var a;Object(h.a)(this,t),(a=Object(v.a)(this,Object(O.a)(t).call(this,e))).handleChange=function(e){if("done"===e.file.status){var t=a.props.onChange,n=e.file.response,r=M+n.hash;t(r),a.setState({loading:!1,imageUrl:r})}},a.beforeUpload=function(){return new Promise((function(e,t){a.setState({loading:!0}),Object(A.a)({method:"get",url:"/upload/qiniu_token"}).then((function(t){var n=t.data.token;a.params.token=n,e(!0)})).catch((function(e){console.log(e),a.setState({loading:!1}),t(e)}))}))};var n=e.value;return a.params={},a.state={loading:!1,imageUrl:n||""},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e,t=this.state,a=t.loading,n=t.imageUrl,r=w.a.createElement("div",null,a?null:w.a.createElement(_.a,{className:T.a.icon,type:"plus"})),l=this.props,i=l.uploadClass,c=void 0===i?T.a.uploadClass:i,o=l.imgClass,s=void 0===o?T.a.imgClass:o,u=l.imgStyle,d=R()((e={},Object(p.a)(e,c,!0),Object(p.a)(e,"hover-mask",n),e));return w.a.createElement(z.a,{listType:"picture-card",action:"https://upload-z2.qiniup.com",data:this.params,className:d,showUploadList:!1,beforeUpload:this.beforeUpload,onChange:this.handleChange},w.a.createElement(I.a,{spinning:a}),n?w.a.createElement("img",{src:n,style:u,className:s,alt:"avatar"}):r,w.a.createElement("div",{className:"uploadr-mask"},w.a.createElement(_.a,{className:T.a.icon,type:"plus"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.value?{imageUrl:e.value||""}:null}}]),t}(C.Component);function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function K(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var B,H=E.a.Item,L=j.a.Option,G=E.a.create()(U=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).state={submitting:!1},a.handleOk=function(e){e.preventDefault(),a.props.form.validateFields(function(){var e=Object(b.a)(m.a.mark((function e(t,n){var r,l,i,c,o,s,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=3;break}return e.abrupt("return");case 3:if(r=a.props.detail,a.setState({submitting:!0}),l={},!r.id){e.next=12;break}return e.next=9,Object(x.f)(K({},n,{id:r.id}));case 9:l=e.sent,e.next=16;break;case 12:return i=n.password,c=Object(N.a)(n,["password"]),e.next=15,Object(x.a)(K({},c,{password:q()(q()(i))}));case 15:l=e.sent;case 16:l.success&&(o=a.props,s=o.onCreateSuccess,u=o.onEditSuccess,d.a.destroy(),d.a.success(r.id?"\u4fee\u6539\u6210\u529f":"\u6dfb\u52a0\u6210\u529f"),r.id?u():s()),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:return e.prev=22,a.setState({submitting:!1}),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,19,22,25]])})));return function(t,a){return e.apply(this,arguments)}}())},a.handleCancel=function(){a.props.onClose(),a.props.form.resetFields()},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.roles,n=void 0===a?[]:a,r=e.detail,l=e.form,i=this.state.submitting,o=l.getFieldDecorator,s=r.id?"\u7f16\u8f91":"\u6dfb\u52a0";return w.a.createElement(u.a,{title:s,width:600,visible:t,onOk:this.handleOk,onCancel:this.handleCancel,destroyOnClose:!1,maskClosable:!1,confirmLoading:i},w.a.createElement(E.a,null,w.a.createElement(H,Object.assign({label:"\u5934\u50cf"},k.a),o("avatar",{rules:[{required:!0,message:"\u8bf7\u4e0a\u4f20\u5934\u50cf!"}],initialValue:r.avatar||""})(w.a.createElement(Y,null))),w.a.createElement(H,Object.assign({label:"\u8d26\u6237\u540d"},k.a),o("userName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d26\u6237\u540d!"}],initialValue:r.userName||""})(w.a.createElement(c.a,{placeholder:"\u8bf7\u8f93\u5165\u8d26\u6237\u540d",allowClear:!0,autoComplete:"off"}))),w.a.createElement(H,Object.assign({label:"\u771f\u5b9e\u59d3\u540d"},k.a),o("fullName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u771f\u5b9e\u59d3\u540d!"}],initialValue:r.fullName||""})(w.a.createElement(c.a,{placeholder:"\u8bf7\u8f93\u5165\u771f\u5b9e\u59d3\u540d",allowClear:!0,autoComplete:"off"}))),!r.id&&w.a.createElement(H,Object.assign({label:"\u5bc6\u7801"},k.a),o("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"}],initialValue:r.password||""})(w.a.createElement(c.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",allowClear:!0,autoComplete:"off"}))),w.a.createElement(H,Object.assign({label:"\u72b6\u6001"},k.a),o("enable",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"}],initialValue:"undefined"===typeof r.enable||r.enable})(w.a.createElement(P.a.Group,{buttonStyle:"solid"},w.a.createElement(P.a.Button,{value:!0},"\u542f\u7528"),w.a.createElement(P.a.Button,{value:!1},"\u7981\u7528")))),w.a.createElement(H,Object.assign({label:"\u89d2\u8272"},k.a),o("role",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u89d2\u8272!"}],initialValue:Array.isArray(r.roles)?r.roles.map((function(e){return e.id})):[]})(w.a.createElement(j.a,{placeholder:"\u8bf7\u9009\u62e9\u89d2\u8272",mode:"multiple",allowClear:!0,getPopupContainer:function(e){return e.parentNode}},n.map((function(e){return w.a.createElement(L,{key:e.id,value:e.id},e.name)})))))))}}]),t}(C.Component))||U,Q=a(529);function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var X=E.a.Item,$=j.a.Option,ee=E.a.create()(B=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1,deleting:!1,list:[],total:0,page:1,size:10,visible:!1,detail:{},roles:[]},a.form={},a.sorter={},a.queryTotalRoles=Object(b.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Q.d)();case 3:(t=e.sent).success&&(n=t.data||[],a.setState({roles:n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),a.query=Object(b.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState({loading:!0}),t=Object.assign({},a.form,a.sorter,{page:a.state.page,size:a.state.size}),e.next=5,Object(x.c)(t);case 5:(n=e.sent).success&&a.setState({list:n.data.list||[],total:n.data.total||0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.prev=12,a.setState({loading:!1}),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),a.handleSearch=function(e){e.preventDefault();var t=a.props.form.getFieldsValue();a.form=t,a.query()},a.handleReset=function(){a.props.form.resetFields(),a.form={},a.query()},a.handleTableChange=function(e,t,n){var r=e.current,l=e.pageSize;a.setState({page:r||1,size:l||10},(function(){var e={};n.field&&n.order?(e.sortProp=n.field,e.sortOrder="ascend"===n.order?1:-1):(e.sortProp=null,e.sortOrder=null),a.sorter=e,a.query()}))},a.handlePaginationChange=function(e,t){a.setState({page:e,size:t},(function(){a.query()}))},a.handleToggleEnable=function(){var e=Object(b.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState({loading:!0}),e.next=4,Object(x.e)({id:t.id,enable:!t.enable});case 4:e.sent.success&&(n=a.state.list.map((function(e){return e.id===t.id?W({},e,{enable:!e.enable}):e})),a.setState({list:n}),d.a.destroy(),d.a.success("\u64cd\u4f5c\u6210\u529f")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:return e.prev=11,a.setState({loading:!1}),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),a.handleDelete=function(e){u.a.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",centered:!0,onOk:function(){a.setState({deleting:!0,loading:!0},Object(b.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(x.b)({id:e.id});case 3:t.sent.success&&(a.query(),d.a.destroy(),d.a.success("\u5220\u9664\u6210\u529f")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:return t.prev=10,a.setState({deleting:!1,loading:!1}),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])}))))},onCancel:function(){}})},a.handleCreate=function(){a.setState({visible:!0}),console.log(a.formRef)},a.handleCreateSuccess=function(){a.setState({visible:!1,page:1,size:10},(function(){a.query()}))},a.handleEdit=function(e){a.setState({visible:!0,detail:e})},a.handleEditSuccess=function(){a.setState({visible:!1,detail:{}},(function(){a.query()}))},a.handleModalClose=function(){a.setState({visible:!1,detail:{}})},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.query(),this.queryTotalRoles()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,u=a.loading,d=a.list,p=a.total,f=a.page,m=a.size,b={visible:a.visible,detail:a.detail,roles:a.roles,onCreateSuccess:this.handleCreateSuccess,onEditSuccess:this.handleEditSuccess,onClose:this.handleModalClose},h={total:p,current:f,pageSize:m,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:this.handlePaginationChange,onShowSizeChange:this.handlePaginationChange},g=[{title:"\u5934\u50cf",align:"center",dataIndex:"avatar",key:"avatar",render:function(e){return w.a.createElement("img",{src:e,className:"avatar",alt:"\u52a0\u8f7d\u5931\u8d25"})}},{title:"\u7528\u6237\u540d",align:"center",dataIndex:"userName",key:"userName"},{title:"\u771f\u5b9e\u59d3\u540d",align:"center",dataIndex:"fullName",key:"fullName"},{title:"\u89d2\u8272",align:"center",dataIndex:"roles",key:"roles",render:function(e){return e&&e.length?e.map((function(e){return w.a.createElement("span",{key:e.id},e.name,w.a.createElement("br",null))})):w.a.createElement("span",null,"-")}},{title:"\u542f\u7528\u72b6\u6001",align:"center",dataIndex:"enable",key:"enable",render:function(t,a){return"admin"===a.userName?w.a.createElement("span",null,"-"):w.a.createElement(s.a,{checked:t,disabled:u,onChange:function(t){return e.handleToggleEnable(a,t)}})}},{title:"\u6dfb\u52a0\u65f6\u95f4",align:"center",dataIndex:"createdAt",key:"createdAt",sorter:!0,render:function(e){return w.a.createElement("span",null,e?Object(S.a)(e):"-")}},{title:"\u4fee\u6539\u65f6\u95f4",align:"center",dataIndex:"updatedAt",key:"updatedAt",sorter:!0,render:function(e){return w.a.createElement("span",null,e?Object(S.a)(e):"-")}},{title:"\u64cd\u4f5c",align:"center",dataIndex:"operation",key:"operation",render:function(t,a){return"admin"===a.userName?w.a.createElement("span",null,"-"):w.a.createElement("span",null,w.a.createElement(o.a,{type:"link",onClick:function(){return e.handleEdit(a)}},"\u7f16\u8f91"),w.a.createElement(o.a,{type:"link",disabled:e.state.deleting,onClick:function(){return e.handleDelete(a)}},"\u5220\u9664"))}}];return w.a.createElement("div",{className:"com-container"},w.a.createElement(E.a,{onSubmit:this.handleSearch},w.a.createElement(l.a,{gutter:24},w.a.createElement(i.a,k.b,w.a.createElement(X,Object.assign({label:"\u7528\u6237\u540d"},k.c),t("userName",{initialValue:""})(w.a.createElement(c.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",allowClear:!0,autoComplete:"off"})))),w.a.createElement(i.a,k.b,w.a.createElement(X,Object.assign({label:"\u771f\u5b9e\u59d3\u540d"},k.c),t("fullName",{initialValue:""})(w.a.createElement(c.a,{placeholder:"\u8bf7\u8f93\u5165\u771f\u5b9e\u59d3\u540d",allowClear:!0,autoComplete:"off"})))),w.a.createElement(i.a,k.b,w.a.createElement(X,Object.assign({label:"\u542f\u7528\u72b6\u6001"},k.c),t("enable",{initialValue:""})(w.a.createElement(j.a,{placeholder:"\u8bf7\u9009\u62e9\u72b6\u6001",allowClear:!0,getPopupContainer:function(e){return e.parentNode}},w.a.createElement($,{value:""},"\u5168\u90e8"),w.a.createElement($,{value:1},"\u542f\u7528"),w.a.createElement($,{value:0},"\u7981\u7528"))))),w.a.createElement(i.a,k.b,w.a.createElement(X,{wrapperCol:{offset:2}},w.a.createElement(o.a,{type:"primary",htmlType:"submit",disabled:u,onSubmit:this.handleSearch},"\u67e5\u8be2"),w.a.createElement(o.a,{onClick:this.handleReset,disabled:u},"\u91cd\u7f6e"),w.a.createElement(o.a,{type:"primary",onClick:this.handleCreate},"\u6dfb\u52a0"))))),w.a.createElement("div",{className:"table-container"},w.a.createElement(r.a,{scroll:{x:1376},loading:u,dataSource:d,columns:g,rowKey:"id",pagination:!1,onChange:this.handleTableChange})),w.a.createElement("div",{className:"pagination-container"},w.a.createElement(n.a,h)),w.a.createElement(G,Object.assign({},b,{wrappedComponentRef:function(t){return e.formRef=t}})))}}]),t}(C.Component))||B;a.d(t,"default",(function(){return ee}))}}]);
//# sourceMappingURL=6.1d80fb43.chunk.js.map