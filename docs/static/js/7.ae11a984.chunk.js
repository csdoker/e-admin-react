(this["webpackJsonpe-admin-react"]=this["webpackJsonpe-admin-react"]||[]).push([[7],{520:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},a={xxl:6,lg:8},c={labelCol:{span:6},wrapperCol:{span:14}}},526:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));n(189),n(190),n(188),n(142),n(141),n(191);var r=n(66),a=n(80),c=n.n(a);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var s=function(e){return c()(e).format("YYYY-MM-DD HH:mm:ss")};function i(e,t,n,a){var c=[];return e.filter((function(e){return e[a]===t})).forEach((function(t){c.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{id:String(t.id),children:i(e,t[n],n,a)}))})),c}},529:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return i}));var r=n(61),a=function(e){return Object(r.a)({method:"get",url:"/role",params:e})},c=function(){return Object(r.a)({method:"get",url:"/role/total"})},o=function(e){return Object(r.a)({method:"post",url:"/role",data:e})},s=function(e){return Object(r.a)({method:"put",url:"/role",data:e})},i=function(e){return Object(r.a)({method:"delete",url:"/role/".concat(e.id)})}},530:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(61),a=function(e){return Object(r.a)({method:"get",url:"/resource",params:e})},c=function(e){return Object(r.a)({method:"get",url:"/resource/total",params:e})},o=function(e){return Object(r.a)({method:"get",url:"/resource/dir",params:e})},s=function(e){return Object(r.a)({method:"post",url:"/resource",data:e})},i=function(e){return Object(r.a)({method:"put",url:"/resource",data:e})},u=function(e){return Object(r.a)({method:"patch",url:"/resource",data:e})},l=function(e){return Object(r.a)({method:"delete",url:"/resource/".concat(e.id),params:e})}},672:function(e,t,n){"use strict";n.r(t);n(527);var r,a=n(531),c=(n(550),n(549)),o=(n(534),n(547)),s=(n(535),n(548)),i=(n(275),n(147)),u=(n(111),n(35)),l=(n(273),n(274),n(93)),d=(n(521),n(523)),p=n(92),f=n.n(p),h=(n(522),n(192),n(145)),m=n(38),b=n(39),g=n(41),y=n(40),O=n(42),v=(n(276),n(113)),j=n(0),k=n.n(j),E=n(520),C=n(526),x=n(529),S=n(530),w=(n(189),n(190),n(191),n(66)),P=(n(188),n(142),n(141),n(201)),T=(n(660),n(663)),D=T.a.TreeNode,K=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(g.a)(this,Object(y.a)(t).call(this,e))).onCheck=function(e,t){var r=t.halfCheckedKeys,a=[].concat(Object(P.a)(e),Object(P.a)(r));n.setState({checkedKeys:e,keys:a}),n.props.onChange({checkedKeys:e,keys:a})},n.onExpand=function(e){n.setState({expandedKeys:e,autoExpandParent:!0})},n.renderTreeNodes=function(e){return e.map((function(e){return e.children?k.a.createElement(D,{title:e.name,key:e.id,dataRef:e},n.renderTreeNodes(e.children)):k.a.createElement(D,{key:e.id,title:e.name})}))};var r=e.value,a=r.checkedKeys,c=r.keys;return n.state={checkedKeys:a||[],keys:c||[],resourceTree:[],expandedKeys:[],autoExpandParent:!0},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.resourceTree;return k.a.createElement(T.a,{autoExpandParent:this.state.autoExpandParent,checkable:!0,selectable:!1,onExpand:this.onExpand,expandedKeys:this.state.expandedKeys,onCheck:this.onCheck,checkedKeys:this.state.checkedKeys},this.renderTreeNodes(e))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value.checkedKeys.length!==t.checkedKeys.length?{checkedKeys:e.value.checkedKeys}:e.value.keys.length!==t.keys.length?{keys:e.value.keys}:e.resourceTree.length!==t.resourceTree.length?{expandedKeys:e.resourceTree.map((function(e){return e.id})),resourceTree:e.resourceTree}:null}}]),t}(j.Component);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(n,!0).forEach((function(t){Object(w.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R,F=v.a.Item,N=v.a.create()(r=function(e){function t(){var e,n;Object(m.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(g.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(a)))).state={visible:!1,submitting:!1,detail:{}},n.open=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id?"\u7f16\u8f91":"\u6dfb\u52a0",r={title:t,visible:!0};e.id&&(r.detail=e),n.setState(r)},n.handleOk=function(e){e.preventDefault(),n.props.form.validateFields(function(){var e=Object(h.a)(f.a.mark((function e(t,r){var a,c,o,s,i,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=3;break}return e.abrupt("return");case 3:if(a=n.state.detail,n.setState({submitting:!0}),c={},o=r.resources.keys.map(Number),!a.id){e.next=13;break}return e.next=10,Object(x.e)(z({},r,{id:a.id,resources:o}));case 10:c=e.sent,e.next=16;break;case 13:return e.next=15,Object(x.a)(z({},r,{resources:o}));case 15:c=e.sent;case 16:c.success&&(s=n.props,i=s.onCreateSuccess,u=s.onEditSuccess,l.a.destroy(),l.a.success(a.id?"\u4fee\u6539\u6210\u529f":"\u6dfb\u52a0\u6210\u529f"),n.handleCancel(),a.id?u():i()),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:return e.prev=22,n.setState({submitting:!1}),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,19,22,25]])})));return function(t,n){return e.apply(this,arguments)}}())},n.handleCancel=function(){n.setState({visible:!1,detail:{}}),n.props.form.resetFields()},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props,t=e.resourceTree,n=void 0===t?[]:t,r=e.form,a=this.state,c=a.visible,o=a.submitting,s=a.detail,u=a.title,l=r.getFieldDecorator,p=s.resources||[],f=p.map((function(e){return e.id})),h=p.filter((function(e){return"2"===e.type})).map((function(e){return e.id}));return k.a.createElement(d.a,{title:u,width:600,visible:c,onOk:this.handleOk,onCancel:this.handleCancel,destroyOnClose:!1,maskClosable:!1,confirmLoading:o},k.a.createElement(v.a,null,k.a.createElement(F,Object.assign({label:"\u89d2\u8272\u540d"},E.a),l("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d!"}],initialValue:s.name||""})(k.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d",allowClear:!0,autoComplete:"off"}))),k.a.createElement(F,Object.assign({label:"\u89d2\u8272\u63cf\u8ff0"},E.a),l("description",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0!"}],initialValue:s.description||""})(k.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0",allowClear:!0,autoComplete:"off"}))),k.a.createElement(F,Object.assign({label:"\u53ef\u7528\u6743\u9650"},E.a),l("resources",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7236\u7ea7\u83dc\u5355!"}],initialValue:{checkedKeys:h,keys:f}})(k.a.createElement(K,{resourceTree:n})))))}}]),t}(j.Component))||r,I=v.a.Item,A=v.a.create()(R=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(g.a)(this,Object(y.a)(t).call(this,e))).state={loading:!1,deleting:!1,list:[],total:0,page:1,size:10,resourceTree:[]},n.form={},n.sorter={},n.query=Object(h.a)(f.a.mark((function e(){var t,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.setState({loading:!0}),t=Object.assign({},n.form,n.sorter,{page:n.state.page,size:n.state.size}),e.next=5,Object(x.c)(t);case 5:(r=e.sent).success&&n.setState({list:r.data.list||[],total:r.data.total||0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.prev=12,n.setState({loading:!1}),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),n.queryTotalResources=Object(h.a)(f.a.mark((function e(){var t,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(S.e)();case 3:(t=e.sent).success&&(r=t.data||[],a=Object(C.b)(r,null,"code","parentCode"),n.setState({resourceTree:a})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.handleSearch=function(e){e.preventDefault();var t=n.props.form.getFieldsValue();n.form=t,n.query()},n.handleReset=function(){n.props.form.resetFields(),n.form={},n.query()},n.handleTableChange=function(e,t,r){var a=e.current,c=e.pageSize;n.setState({page:a||1,size:c||10},(function(){var e={};r.field&&r.order?(e.sortProp=r.field,e.sortOrder="ascend"===r.order?1:-1):(e.sortProp=null,e.sortOrder=null),n.sorter=e,n.query()}))},n.handlePaginationChange=function(e,t){n.setState({page:e,size:t},(function(){n.query()}))},n.handleDelete=function(e){d.a.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",centered:!0,onOk:function(){n.setState({deleting:!0,loading:!0},Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(x.b)({id:e.id});case 3:t.sent.success&&(n.query(),l.a.destroy(),l.a.success("\u5220\u9664\u6210\u529f")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:return t.prev=10,n.setState({deleting:!1,loading:!1}),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])}))))},onCancel:function(){}})},n.handleCreate=function(){n.modalRef.open()},n.handleCreateSuccess=function(){n.setState({page:1,size:10},(function(){n.query()}))},n.handleEdit=function(e){n.modalRef.open(e)},n.modalRefFn=function(e){return n.modalRef=e},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.query(),this.queryTotalResources()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,n=this.state,r=n.loading,l=n.list,d=n.total,p=n.page,f=n.size,h={resourceTree:n.resourceTree,onCreateSuccess:this.handleCreateSuccess,onEditSuccess:function(){return e.query()}},m={total:d,current:p,pageSize:f,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:this.handlePaginationChange,onShowSizeChange:this.handlePaginationChange},b=[{title:"\u89d2\u8272\u540d",align:"center",dataIndex:"name",key:"name"},{title:"\u89d2\u8272\u63cf\u8ff0",align:"center",dataIndex:"description",key:"description"},{title:"\u6dfb\u52a0\u65f6\u95f4",align:"center",dataIndex:"createdAt",key:"createdAt",sorter:!0,render:function(e){return k.a.createElement("span",null,e?Object(C.a)(e):"-")}},{title:"\u4fee\u6539\u65f6\u95f4",align:"center",dataIndex:"updatedAt",key:"updatedAt",sorter:!0,render:function(e){return k.a.createElement("span",null,e?Object(C.a)(e):"-")}},{title:"\u64cd\u4f5c",align:"center",dataIndex:"operation",key:"operation",render:function(t,n){return"\u8d85\u7ea7\u7ba1\u7406\u5458"===n.name?k.a.createElement("span",null,"-"):k.a.createElement("span",null,k.a.createElement(u.a,{type:"link",onClick:function(){return e.handleEdit(n)}},"\u7f16\u8f91"),k.a.createElement(u.a,{type:"link",disabled:e.state.deleting,onClick:function(){return e.handleDelete(n)}},"\u5220\u9664"))}}];return k.a.createElement("div",{className:"com-container"},k.a.createElement(v.a,{onSubmit:this.handleSearch},k.a.createElement(o.a,{gutter:24},k.a.createElement(s.a,E.b,k.a.createElement(I,Object.assign({label:"\u89d2\u8272\u540d"},E.c),t("name",{initialValue:""})(k.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d",allowClear:!0,autoComplete:"off"})))),k.a.createElement(s.a,E.b,k.a.createElement(I,{wrapperCol:{offset:2}},k.a.createElement(u.a,{type:"primary",htmlType:"submit",disabled:r,onSubmit:this.handleSearch},"\u67e5\u8be2"),k.a.createElement(u.a,{onClick:this.handleReset,disabled:r},"\u91cd\u7f6e"),k.a.createElement(u.a,{type:"primary",onClick:this.handleCreate},"\u6dfb\u52a0"))))),k.a.createElement("div",{className:"table-container"},k.a.createElement(c.a,{scroll:{x:1376},loading:r,dataSource:l,columns:b,rowKey:"id",pagination:!1,onChange:this.handleTableChange})),k.a.createElement("div",{className:"pagination-container"},k.a.createElement(a.a,m)),k.a.createElement(N,Object.assign({},h,{wrappedComponentRef:this.modalRefFn})))}}]),t}(j.Component))||R;n.d(t,"default",(function(){return A}))}}]);
//# sourceMappingURL=7.ae11a984.chunk.js.map